<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Inbound Timeline Viewer</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            padding: 20px;
            background: #1e1e1e;
            color: #ffffff;
        }
        h1 {
            font-size: 1.6em;
            color: #ffffff;
        }

        .accordion {
            background-color: rgb(255, 182, 26);
            color: rgb(0, 43, 73);
            font-weight: bold;
            cursor: pointer;
            padding: 14px;
            margin-bottom: 5px;
            width: 100%;
            border: none;
            text-align: left;
            font-size: 1em;
            border-radius: 6px;
            transition: background-color 0.2s ease;
        }

        .accordion:hover {
            background-color: rgb(255, 199, 60);
        }

        .accordion.active {
            background-color: rgb(255, 199, 60);
        }

        .panel {
            display: none;
            overflow: hidden;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #2b2b2b;
            color: #ffffff;
            border-radius: 6px;
            overflow: hidden;
        }

        th, td {
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        th {
            background-color: #333;
            color: #fff;
            border-bottom: 2px solid #444;
        }

        td {
            border-bottom: 1px solid #444;
        }
    </style>
</head>
<body>
    <h1>Inbound Product Timeline</h1>
    <div id="container">Loading data...</div>

    <script>
        const jsonUrl = "Inbound_Timeline.json?v=" + new Date().getTime();

        fetch(jsonUrl)
            .then(response => response.json())
            .then(data => {
                const grouped = {};
                data.forEach(item => {
                    if (!grouped[item.group]) grouped[item.group] = [];
                    grouped[item.group].push(item);
                });

                const container = document.getElementById("container");
                container.innerHTML = "";

                const groupOrder = ["This Month", "Next Month", "2+ Months Out", "TBA"];
                groupOrder.forEach((groupName, index) => {
                    if (!grouped[groupName]) return;

                    // Accordion Button
                    const btn = document.createElement("button");
                    btn.className = "accordion";
                    btn.textContent = groupName;
                    container.appendChild(btn);

                    // Panel with table
                    const panel = document.createElement("div");
                    panel.className = "panel";

                    const table = document.createElement("table");
                    const thead = document.createElement("thead");
                    thead.innerHTML = `
                        <tr>
                            <th>SKU</th>
                            <th>Description</th>
                            <th>ETA</th>
                            <th>Communicated Date</th>
                            <th>Quantity</th>
                        </tr>
                    `;
                    table.appendChild(thead);

                    const tbody = document.createElement("tbody");
                    grouped[groupName].forEach(item => {
                        const row = document.createElement("tr");
                        row.innerHTML = `
                            <td>${item.sku}</td>
                            <td>${item.description}</td>
                            <td>${item.eta || "-"}</td>
                            <td>${item.communicated_date}</td>
                            <td>${item.quantity || "-"}</td>
                        `;
                        tbody.appendChild(row);
                    });
                    table.appendChild(tbody);
                    panel.appendChild(table);
                    container.appendChild(panel);

                    // Expand first group by default
                    if (index === 0) {
                        panel.style.display = "block";
                        btn.classList.add("active");
                    }
                });

                // Accordion toggle behavior
                const acc = document.getElementsByClassName("accordion");
                for (let i = 0; i < acc.length; i++) {
                    acc[i].addEventListener("click", function () {
                        const panel = this.nextElementSibling;
                        const isOpen = panel.style.display === "block";
                        panel.style.display = isOpen ? "none" : "block";
                        this.classList.toggle("active", !isOpen);
                    });
                }
            })
            .catch(err => {
                document.getElementById("container").textContent = "Failed to load data.";
                console.error(err);
            });
    </script>
</body>
</html>
